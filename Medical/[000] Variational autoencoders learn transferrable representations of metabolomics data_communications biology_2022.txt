<Abstract>
- 차원 축소는 데이터 양이 많은 경우에 한해서 종종 진행되어 왔다.
- 하지만 최근 SOTA모델들은 굳이 차원축소를 진행하지 않아도, 대용량 데이터를 처리 할 수 있게 되었다.
- 그중에서도 VAEs는 unseen data를 생성하는 nonlinear latent representations을 학습하기 위해서 디자인되었다.
- 본 논문에서는 4500명의 혈액 sample을 처리하기 위해서 VAE를 학습시키고자 한다.
- global feature importance score를 사용해서 잠재적 차원이 별개의 cellular 과정을 나타낸다는 것을 보여주고자 한다.
- 본 모델의 일반화 성능을 입증하기 위해서, 두 가지 타입의 당뇨병 데이터 셋과 급성 골수성 백혈병 그리고 조현병, 임상 실험을 하는 환자들간의 유의미한 상관관계를 찾아내었습니다.
- 특히 VAE를 사용하는 경우 linear 하던 nonlinear하던 간에, 주성분 분석에 의해 도출된 latent dimension보다 더 좋은 효과를 보여주었습니다.
- VAE는 생물학적인 의미, nonlinear, 그리고 최근의 방대한 데이터를 transferrable 하는데 의미가 있다는 것을 입증하였습니다.

<Introduction>
- 최근에 등장하는 데이터 셋들은 방대한 양을 가지고 있으며, 이는 수천명의 참가자와, 인간의 오랜 연구 끝에 얻어낸 것이다.
- 이러한 데이터 셋들은, 주기적으로 병에 대한 분자 구조 표현형을 업데이트 하고, 근본적인 병리학적 mechanism을 확인함으로써 생성되었다.
- 수많은 참가자들이 참여함으로써, 방대향 양의 데이터 셋에서 차원 축소를 통해 시스템적 효과를 밝혀내고자 했습니다.
- 연구 끝에, PCA(Principal component analysis)나 ICA(Independent component analysis)는 방대한 양의 생물학적 데이터 셋에 적합하다는 것을 알아냈습니다.
-  그러나 좀더 복잡한 생물학 과정에서는, non-linear 효과를 포함하는데, 이는 효소 반응속도론이나 유전자 조절 과정에서 발생한다.
- 예를 들어, 대사산물 비율은 대사체학 데이터에서 비선형 효과를 감지하기 위해 직관적이고 널리 사용되는 접근 방식으로, 반응물과 대사 반응 생성물 사이의 정상 상태를 근사화합니다.
- 이 개념을 확장하여, 체계적인 방법은 nonlinearities를 unbiased fashion내에서의 metabolties의 기능적인 상호작용을 전부 정확하게  복구하는 account에 사용한다.
- AEs(Autoencoders)는 non-linear 효과를 capture가능하게 하는 unsuperivsed한 신경망 차원 축소 아키텍쳐의 한 종류이다.
- AEs는 낮은 차원 공간에 입력값을 통과시키는 encoding/decoding을 거쳐서 높은 차원의 데이터를 처리한다.
- 모델이 한번 맞춰지면, 잠재 변수는 훨씬 간소해지며, 원본 데이터를 설명하는게 훨씬 수월해집니다.
- AEs가 biological 데이터 셋을 예측하는데 성공적인 반면, 주어진 입력 데이터 셋에 맞추어 지고, training 데이터 셋으로부터 유전학적으로 존재하지 않는 것에 대해서는 생성해내지 못한다.
- 본 문제를 해결하기 위해서, VAEs는 사전 분배된 잠재 변수들을 제한하는 AE 구조의 확률적 확정이라고 볼 수 있다.
- 이러한 확장으로 인해, VAE는 단순히 입력 데이터를 재구성하는것 뿐만 아니라, 데이터 뒤에 숨겨진 생성 과정을 추론하여, 다양한 데이터셋에 걸쳐 높은 일반화 성능을 갖게 됩니다.
- 예를 들어 VAE(Variational Autoencoder) 아키텍처는, 훈련 중에 사용되지 않은 세포 유형의 전사체 데이터로부터 감염에 대한 세포 수준의 반응을 예측하는 데 효과적으로 입증되었으며, 약물 반응 정보가 드물었던 유전자 발현 데이터로부터 약물 반응을 예측하는 데에도 효과적입니다.
- 또한, 유전자 발현 데이터로 훈련된 VAE 모델의 잠재 차원은 임상 파라미터와 강력하게 연관되어 있으며, 생물학적으로 의미 있는 경로를 포착하는 데 있어서 다른 일반적인 저차원 표현 방법인 PCA(주성분 분석)와 k-means 클러스터링을 능가했습니다. 
- 이러한 결과는 VAE가 유전자 발현 데이터에 대해 훈련될 때, 해당 데이터의 생물학적인 특성을 잘 포착하여 다른 저차원 표현 방법보다 우수한 성과를 보여준다는 것을 시사합니다.
- 대부분의 다른 omics에 비해 대규모 대사체(cohort) 데이터의 부족으로 인해, 대사체학 데이터에 대한 심층 학습 구조의 적용이 상당히 지연되었습니다.
- 과거 연구 중 하나는 (비변이적) 오토인코더를 작은 규모의 대사체학 샘플(n = 271)에 적용했으며, 모델의 잠재적 표현을 사용하여 유방암 환자의 ER(호르몬 수용체) 상태를 일반적인 머신러닝 방법보다 우수하게 예측하였습니다.
- 대규모 대사체학 데이터에 VAE(Variational Autoencoder) 아키텍처를 적용함으로써, 비선형 효과를 체계적으로 설명하는 더 정확한 잠재적 차원 표현을 학습할 수 있는 잠재력을 가지고 있습니다.
- 또한, VAE(Variational Autoencoder)의 확률적 구조는 여러 데이터셋에 걸쳐 일반화할 수 있는 잠재적인 차원을 학습합니다.
- 이 논문에서는 TwinsUK 연구(25번 참고)의 4644개 혈액 샘플에서 217가지 대사물질 측정치로 VAE 모델을 훈련하고 선형 및 비선형 PCA 모델과 비교하여 모델 성능을 평가했습니다 (Fig. 1a).
- VAE와 PCA의 학습된 잠재 차원의 생물학적 관련성을 조사하기 위해 각 입력이 각 잠재 차원에 기여하는 정도를 결정하는 Shapley Additive Global Importance (SAGE) 방법론을 사용했습니다. 
- 우리는 다양한 세부 수준에서 SAGE 값을 계산했습니다. 즉, 대사물질, 서브 패스웨이 및 슈퍼 패스웨이 수준에서 계산했습니다.
- 그런 다음 이 모델들을 세 가지 추가 혈액 대사물질 데이터셋에 적용하여, 보이지 않는 데이터셋에서 질병 표현형을 복원하는 능력을 테스트했습니다: Type 2 Diabetes 진단의 카타르 대사물질 연구(QMDiab, n = 358), 급성 골수성 백혈병 데이터셋(AML, n = 85)의 치료 반응, 그리고 제 3의 유효성 검증 데이터셋에서의 조현병 진단(n = 201).

<Results>
[VAE model construction and fitting]
- 우리의 VAE 아키텍쳐는 input/output 레이어로 구성되어 있고, intermediate layer와 latent layer로 구성되어 있다. 
- TwinsUK 집단을 85%는 트레이닝 셋으로, 나머지 15%는 테스트 셋으로 하였다.
- 트레이닝 세트는 VAE모델 내에서 hyperparameter를 조정하기 위해서 사용되었다.
- Keras Tuner는 다음과 같이 하이퍼파라미터를 설정했습니다.
- 중간 레이어의 차원 = 200, 학습률 = 0.001, 그리고 Kullback-Leibler (KL) 발산 가중치 = 0.01 (자세한 내용은 Methods 참조).
- 이러한 매개변수를 고정한 상태에서 우리는 잠재 레이어 z의 차원 d를 최적화하기 위해 대사물질의 상관 행렬(CM-MSE)의 재구성 MSE를 계산했습니다.
- 우리는 CM-MSE 곡선이 d = 18 이후로 수렴하여, 이 값 이상으로 잠재 차원을 증가시켜도 모델의 개선이 거의 없음을 관찰했습니다.
- 모델의 최종 구조는 217 차원의 입력/출력 레이어(데이터셋 내 대사물질 수), 200 차원의 중간 레이어, 그리고 18 차원의 잠재 레이어로 구성되었습니다.
- 우리는 주성분 분석(PCA)을 베이스라인 모델로 사용하여 VAE를 선형 잠재 변수 임베딩 방법과 비교했습니다.
- 이를 위해, 우리는 TwinsUK 학습 데이터에 PCA를 적합시키고 첫 번째 d=18 차원, 즉, 주성분을 추출했습니다.
- 우리의 VAE  모델을 비교하기 위해서 non-linear한 latent 하고 다양한 방법을 사용한다.
- PCA모델을 cosine similarirty, sigmoid, RBF, 그리고 다항식 커널 기법을 사용한다.
- 트레이닝 데이터 셋에 관해서, PCA던 VAE던 간에 KPCA데이터 matrix 재구성에 좋은 성과를 보였다.
- 테스트 데이터 셋에 대해서는, PCA와 VAE 중에 KPCA모델을 사용하는 경우 PCA가 더 좋은 성능을 보여주었다.
- 선형 모델인 KPCA(Kernel PCA)와 VAE(Variational Autoencoder)가 PCA(Principal Component Analysis)보다 상관 행렬 재구성에서 뛰어난 성능을 보였으며, 이 결과는 CM-MSE라고 불리는 correlation matrix reconstruction을 통하여 평가되었다.
- 상관 행렬에 대한 MSE(평균 제곱 오차)와 일반적으로 사용되는 샘플별 MSE 간의 차이는 재구성 성능을 평가하는 방법에 대한 모호성을 드러냅니다.
- 특히, 다른 저자들은 이전에 증명되었듯이, 샘플 재구성 성능이 더 좋은 모델 성능을 반드시 의미하지는 않는다는 것을 보여 주었습니다.
- 이는 KPCA(커널 PCA)의 샘플 재구성이 교육 및 테스트 세트 간에 큰 차이가 있음에도 불구하고 입증되었습니다.
- 그러나 우리의 결과는 비선형 방법이 원본 데이터 행렬을 정확하게 재구성하지는 않지만, 대사물질 간의 상관 관계를 보존하는 데 PCA보다 우수하다는 것을 시사합니다.

[Interpretation of VAE latent space dimensions in the context of metabolites and pathways]
- 대사물질 경로에서 사용되지 않는 데이터 셋에 대한 맥락 구성을 평가하였습니다.
- Sub-pathway 와 Super-pathway를 사용합니다.
- Sub-pathway는 "TCA 사이클" 및 "스핑고지질 대사"와 같은 생화학적 과정을 의미하는 반면, Super-pathway는 "지질" 및 "아미노산"과 같은 광범위한 그룹입니다.
- 다른 VAE 차원에 의해 표현된 과정을 설명하기 위해, 우리는 metabolites(대사물질), sub-pathways(하위 경로), 그리고 super-pathways(상위 경로) 수준에서 모델 특징의 관련성을 측정하는 지표인 SAGE 점수를 계산했습니다
- PCA 및 KPCA 결과는 부록 그림 5에서 9까지 찾아볼 수 있습니다.
- VAE sub-pathways의 heatmap(그림 3a)은 거의 모든 차원이 지질 및 아미노산의  super-pathways에서 주요한 기여를 보여줍니다.
- 두 상위 경로의 보편성은 해당 그룹이 데이터셋 내에서 가장 많은 수의 대사물질을 포함하고 있기 때문에 발생한 것으로 해석될 수 있습니다.
- 주목해야 할 점은 우리가 'Unknown(미확인)' 분자 그룹을 일부러 제외했다는 것입니다. 이 그룹은 어떤 경로에서든 유래될 수 있는 식별되지 않은 대사물질을 가리킵니다.
- SAGE 값들을 다른 방향에서 검토해볼 때, 거의 모든 sub-pathways는 대부분 해당 경로를 가장 잘 포착하는 단일 VAE 차원에 의해 주로 표현됩니다.
- 예를 들어, "글리콜리시스, 글루코네오제네시스 및 피루베이트 대사"는 "알라닌 및 아스파타트 대사"  sub-pathways와 글루코스-알라닌 순환을 통해 기능적으로 관련되어 있으며, 두 가지 모두 VAE 차원 12로 표현되었습니다.
- 다른 흥미로운 예는 VAE 차원 14인데, 이 차원은 케톤 신체, 지방산 대사, 그리고 TCA 사이클과 같은 중요한 분해 과정을 포착했습니다.
- 이러한 결과들을 종합하면, VAE 잠재 공간 차원은 기능적으로 관련된 서브 패스웨이들의 복합적인 조합을 포착하며, 이로써 데이터셋 내 주요 대사 과정을 포착함을 보여줍니다.
- 반면에, PCA와 KPCA 차원 1에서 5는 데이터 내에서 가장 큰 변동성을 나타내는데, 이는 sub-pathway내에서 포착된 특정하지 않은 고차원의 데이터를 포함하고 있기 때문입니다.
- 대부분의 다른 PCA와 KPCA 차원들 또한 주로 관련 없는 서브 패스웨이들을 주로 포함하고 있었습니다.

[VAE latent space captures signals in unseen diabetes, schizophrenia, and cancer metabolomics datasets]
- 다른 데이터 셋을 생성 가능하게 하는 정보를 포함하고 있는 TwinUK데이터를 VAE latent dimension이 학습하고 있는 지를 조사했다.
- 종국에는, 2형 당뇨병, AML(급성 골수성 백혈병), 그리고 조현병을 TwinsUK데이터 셋에 대해서 학습한 VAE, PCA, KPCA 인코더를 사용하여 대사물질 데이터를 인고딩 합니다.
- VAE, PCA 그리고 KPCA latent dimension에 대해서, 당뇨병 환자와 일반인, full(?)과 AML 임상시험에서 반응 없는 사람들, 조현병 환자와 일반인의 two-sided t-test를 각각 진행하였다.
- 모든 데이터 셋을 통틀어서, VAE dimensions는 환자 집단에 대해 PCA나 KPCA보다 훨씬 월등한 성능을 보여주었다.
- VAE dimension과 질병 파라미터의 연관성의 강도는 단일 대사 활동에 맞먹는 정도다.
- 그러나 VAE 차원과 달리, 이러한 일변량 연관성(univariate associations)은 질병과 관련된 체계적인 수준의 메커니즘을 나타내지 않습니다.
- 특히, 결과는 d = 18보다 다른 차원에서 크게 다르지 않았습니다.
- VAE 연관성의 주요 요인을 이해하기 위해, pathway랑 대사활동을 계산된 SAGE 값에 따라 rank를 매겼습니다.

[유형 2 당뇨병]
- 유형 2 당뇨병에 대해서, VAE latent dimension 12는 두 번째로 높은 PCA차원 16 보다 더 높은 연관성을 보여주었습니다.
- top sub-pathway(대사경로)는 글리콜리시스, 글루코네오제네시스, 그리고 피루베이트 대사", "라이솔리핏", 그리고 "글리신, 세린, 스레오닌 대사"였습니다.





<🎨🖼🎭🎪🎢새롭게 알게 된 단어🎨🖼🎭🎪🎢>
- latent space dimensions : 딥러닝에서 feature를 제외한 나머지 부분
- metabolites and pathways : 대사 활동 및 생물학적 프로세스를 이해하고 분석하는 데 사용되는 중요한 개념들
- cohort : 집단, 지지자
- acute myeloid leukemia : 급성 골수성 백혈병
- schizophrenia : 조현병
- molecular : 분자구조 / 생물학
- phenotype : 표현형 (genotype), 생물의 형질 
- pathological : 병적인, 병리학의, 병에 의한
- enzyme kinetics : 효소 반응속도론, 효소에 의한 화학반응을 연구하는 학문
- biological phenomena : 유전학
- metabolism : 대사 또는 대사 과정 : 세포 안에서 일어나는 모든 화학반응을 총칭
- sub-pathways : 하위 경로
- Amino acid : 아미노산 : 아미노산은 단백질의 구성 요소이며, 아미노산 대사는 단백질 합성과 분해를 포함한 과정을 가리킵니다.
- clinical trial : 임상시험
- univariate associations : 일변량 연관성
- driving factor : 주된 요소


<🧨새로운 개념🧨>

- Metabolites(대사물질): 이들은 생물학적 시스템 내에서 발생하는 작은 유기 화합물로, 대사 과정의 결과물이거나 대사 활동에 참여하는 물질들을 가리킵니다. 이들은 생명체에서 에너지를 생성하거나 필요한 물질을 만들기 위한 화학 반응의 결과로 생성되며, DNA 및 RNA와 같은 생체 기능을 수행하는 데 필수적입니다.

- Pathways(대사경로): 생물학적 경로는 여러 단계의 생화학적 반응이 특정 생물학적 프로세스를 완료하기 위해 연결된 일련의 단계를 나타냅니다. 예를 들어, 대사 경로는 특정 대사 물질이 생성되거나 분해되는 과정을 설명하는 연결된 생화학적 단계입니다. 이러한 경로는 생체 내에서 에너지 생성, 탄수화물 분해, 단백질 합성 등과 같은 주요 생물학적 기능을 수행하는 데 중요합니다.

- TCA Cycle : 트리카르복실산 사이클 : 이는 세포 내에서 에너지를 생성하기 위해 중요한 역할을 하는 과정으로, 탄소화된 물질을 산화하여 에너지를 생산합니다.

- Sphingolipid Metabolism : 스핑고지지드 대사 : 이는 지질 대사의 일부로, 스핑고지드라는 지질을 합성하거나 분해하는 과정을 의미합니다.

- Lipid : 지질 : 이는 지질 대사에 관련된 모든 생화학적인 활동을 포괄합니다. 지질은 세포 막의 구성, 에너지 저장 및 전달, 신호 전달 등에 중요한 역할을 합니다.

- Lysolipid(라이솔리핏)은 지방대사의 하위 그룹 중 하나로, 지질(지방) 대사의 일부를 형성하는 유기 화합물입니다. 지질 대사는 지방산, 그리세롤, 포스포릴라이딘 등과 같은 유기 분자들의 생성, 분해 및 이용을 포함합니다. "Lysolipid"는 지질 대사에서 중요한 부분을 차지하며, 리포프로테인이나 세포막 구조 등과 관련된 역할을 합니다.

[아래 세 가지 과정은, 세포 내에서 중요한 탄수화물 대사 과정으로, 에너지 생성과 혈당 조절에 관여하며, 다른 대사 경로에 영향을 받을 수 있음]

- 글리콜리시스(Glycolysis): 글리콜리시스는 포도당과 같은 탄수화물을 분해하여 피루빅산과 같은 대사 중간체를 생성하는 과정입니다. 이 과정은 세포 내에서 에너지를 생성하는 초기 단계로, 당분해 과정 중에서 중요한 역할을 합니다.
- 글루코네오제네시스(Gluconeogenesis): 글루코네오제네시스는 지방과 단백질 등에서 포도당과 같은 당분을 생성하는 과정입니다. 이것은 글리콜리시스의 반대 과정으로, 에너지 공급이 부족한 상황에서 혈당 수준을 유지하기 위해 중요합니다.
- 피루베이트 대사(Pyruvate Metabolism): 피루베이트는 글리콜리시스 과정 중에서 생성되는 대사 중간체입니다. 피루베이트 대사는 이 중간체를 다양한 다른 대사 경로로 전환하거나 활용하는 과정을 의미합니다.

[아래 두 가지 과정은, 단백질 대사와 관련이 깊어, 아미노산의 생성, 분해, 그리고 다른 대사 경로와의 상호 작용을 포함합니다. 알라닌과 아스파타트는 다양한 생체 기능과 대사 활동에서 중요한 역할을 하는 아미노산임]
- 알라닌(Metabolism of Alanine): 알라닌은 단백질 대사 과정에서 생성되는 아미노산 중 하나입니다. 이것은 근육 조직에서 생성되며, 혈당 조절에 중요한 역할을 하는 글리코겐 생성에 사용될 수 있습니다.
- 아스파타트(Metabolism of Aspartate): 아스파타트는 다른 아미노산과 결합하여 단백질을 구성하는 아미노산입니다. 이외에도 아스파타트는 크레아틴과 카르니틴의 생성, 그리고 요구르트산과 같은 중요한 생화학적 반응에 참여할 수 있습니다.

[아래 과정은 몸에서 에너지를 생성하고 에너지 공급을 조절하는 데 중요한 역할을 함]
- 케톤 신체(Ketone bodies): 케톤 신체는 일정한 단백질과 지방을 대사해 생성되는 유기 화합물입니다. 보통 급격한 탄수화물 공급 부족 시, 예를 들어 당뇨병이나 단식 상황에서, 간에서 지방을 분해하여 케톤 신체를 생성합니다. 이들은 에너지원으로 사용될 수 있으며 중요한 에너지 공급원으로 작용할 수 있습니다.
- 지방산 대사(Fatty acid metabolism): 지방산 대사는 지방이나 고지방 식품을 소비할 때 발생하는 생화학적 과정입니다. 이러한 과정은 식사로부터의 에너지 생산과 함께 체내 에너지 저장과 관련되어 있습니다. 지방산 대사는 지방을 분해하고 에너지로 전환하는 과정을 포함합니다.

[아래 것들은 아미노산으로, 단백질 구성 요소로 작용하며, 세포의 생존 및 기능에 필수적입니다.]
- Glycine, Serine, and Threonine metabolism : 글리신, 세린, 그리고 스레오닌의 대사
- 생체 내에서 중요한 역할을 함
- 글리신 : 중요한 신호 전달자 및 대사 작용
- 세린 & 스레오닌 : 다양한 생물학적 프로세스에 참여함


<나중에 시도해 볼만한 것들 & 논문 뒷받침 참고가 될만한 내용>
- 

<참고한 블로그>

<논문 요약>

